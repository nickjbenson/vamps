# v6CL_6_3_net.py
# Input: Muscle Contraction.
# Output: Muscle Length.

import numpy as np

class Network(object):
    def __init__(self):
        # Note: This is not a generic Network implementation,
        # but a manually re-expressed set of network
        # weights as trained (and originally implemented) in
        # MATLAB.
        # v6CL_6_3_net, a closed-form network with 6 hidden
        # layers and 3 delay states in both the input layer and
        # output-feedback-in layer, specifically, as trained
        # on 18-muscle-contraction input and 18-muscle-length output.

        # Input 1 #
        self.x1_step1_xoffset = np.array([[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0]])
        self.x1_step1_gain = np.array([[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2]])
        self.x1_step1_ymin = np.array([-1])

        # Layer 1 #
        self.b1 = np.array([[-1.0459394389000078],[0.51324374940912931],[0.3173303825989276],[0.081107319461045907],[-0.21588129709948381],[0.52507711199115581]])
        self.IW1_1 = np.array([[-0.022985885174981267,-0.11151532506714543,-0.023816011893557781,0.059301989906567348,0.10509815520014743,-0.0074612007462412835,0.29100434429087901,0.0026611496367296419,-0.069069157170853934,0.014123217496109265,-0.035984908172455539,-0.20859406146640594,0.60963239002062652,0.37896470729086212,-0.29695734436698801,0.21913175219647751,-0.42691396615367222,-0.56770076443162731,0.054262181064817679,0.20085672169228572,0.059355066107221126,-0.06987548174669006,-0.23945762391222039,0.0055914875372641273,-0.25673442812478386,0.013013110280578806,0.066260191551493458,-0.028754819145921047,0.0014519967418373204,0.18899959898650281,-0.62549911745842146,-0.40324680455393563,0.30975089958020835,-0.26253642101559632,0.45250162015793,0.5946312733152741,-0.032638526177952924,-0.07742791013591957,-0.026455228871007139,0.010613986278193654,0.10829752721378894,-0.0027825471292445363,-0.027634484565157685,-0.016083331351952453,-5.5770503328808878e-05,0.014912328970399107,0.035443569419145629,0.015371704903077555,0.035684993592885808,0.036810533736929794,-0.023194331443057079,0.05174706407864503,-0.039266681634142771,-0.044580679364115888],[9.3308647356815311e-05,0.037143448398354963,0.0083427598615680026,-0.0089410180690845543,-0.0042963831616465425,-0.0065330904584235249,-0.09280938673262959,-0.26887605849244284,-0.16731269478236943,0.14814691943213543,0.28637202274418022,0.17230045325784771,0.11347594723697398,-0.19425290849938012,-0.2946787254370305,0.27086636224531291,0.17862988356039461,-0.07241732443032145,-0.0012885161253791575,-0.0099341962451028644,-0.0019387201859518964,-0.011045827545966225,-0.012592217474844106,0.01059298670691315,0.10682263050088971,0.25663565004256805,0.17183244202161155,-0.13360153552582341,-0.27570966008781245,-0.15508977438802826,-0.14126095300691385,0.14530597872227943,0.31137301667084272,-0.28614471974472677,-0.13366927498419426,0.11930491413317597,0.0028756701935593152,-0.017140971748580459,-0.0048266511908881043,0.017279455796320113,0.010619411453099461,-0.0034518078774040473,-0.013972898372222977,0.0085185837924158098,-0.0071236409665325117,-0.012467028699725272,-0.0069191137851312146,-0.016279648744681512,0.033403673259973739,0.049118578718865907,-0.022771323429173561,0.020688410020236834,-0.045851242255760497,-0.051641733332228865],[-0.0045940476237485419,0.044797733307018771,0.041244651916586779,-0.013949707920453738,-0.084928360296306502,-0.018672340854439719,-0.19792517281363722,-0.240674866458955,-0.14454578112334429,0.070442594535924066,0.23836523246269423,0.22859838106443739,-0.15066818325841763,-0.35493209116977992,-0.15972183992266933,0.087865009779897474,0.28936169503571557,0.19245206662063857,-0.017195640070070548,-0.068930507675770678,-0.040131989820374601,0.029195559621884692,0.10578942926025046,0.017192485469945853,0.20108160280402784,0.22585482827504449,0.10663492440389459,-0.085704111683272258,-0.20282574037963,-0.19864933718433747,0.14538462633469371,0.31280397393079179,0.13528659049573183,-0.099660948296202673,-0.25999416948633924,-0.17852347429931142,0.020360350603246549,0.021199451794754322,-3.7410753273212045e-05,-0.014125258784230014,-0.025243376338600271,-0.00061881350542298771,-0.0041918328891290928,0.011914532464498747,0.035006297025591243,0.015158839967142193,-0.032754187327260466,-0.025646810868777476,0.0032254222000786242,0.036232054468776281,0.022401593100528076,0.011889694527137252,-0.026052777768308773,-0.00936114802462624],[0.0031312483290131285,0.0031836277669167138,-0.0043730490679693146,-0.012323480307214659,-0.0099932859957693812,0.019602392533718149,-0.10290202325497028,-0.055395332160989401,0.023621498904102874,0.016358156359596629,0.012028355020803395,-0.07966017279485528,-0.063894623011666721,-0.0075928871297011608,0.018712307998705869,0.011827330536465877,0.02373774208922921,-0.020403055678417589,-0.029097138106149143,-0.035532668437183293,0.0035880843185221931,-1.8107098743886204e-05,0.035423788674433188,-0.034081881834476899,0.090542536168430832,0.056272724653410836,-0.039666363288191731,-0.022598263436260538,-0.0041504213078549469,0.096393707367589149,0.040015427240235241,-0.0021569352529822875,-0.018638451329724907,-0.012618523215890964,-0.030561920048716402,0.00077308694341442132,0.024834833150815794,0.027056924614247149,-0.0027547734325605337,0.011747199590183242,-0.019398569685893152,0.014173185565108902,0.0094650678918419516,-0.0023021042105410448,0.016394953209064894,0.0068113410428465148,-0.0078005114639881669,-0.01639918196718675,0.019762311616485319,0.0066227254435722895,0.0013234167015643498,0.0004910612386147485,0.0098090580558202398,0.021819878659102874],[-0.0022729592563955564,-0.088825510835989038,-0.025140577078282551,0.020870316915554903,0.095063863035536891,0.0072404818603173564,-0.0394052152266069,-0.22230912801237543,-0.11673793094609489,0.12546577203706444,0.20367188506482153,-0.03162708429789772,0.34523825233312966,0.10826145626382154,-0.3414565037732003,0.34329870335438301,-0.10257538476441289,-0.3858748209783332,-0.00017787965519382252,0.079849883401006197,0.025514180871657209,-0.043405455740560948,-0.091072688060054169,-0.012443928987720461,0.01414390282141249,0.24865263424175643,0.14853799475014606,-0.13066639317924711,-0.23938561666798716,0.042551626790737769,-0.45435165026550522,-0.15879481343888477,0.43567635036143765,-0.41159373727854065,0.15554787778762075,0.46268904892957174,0.001527749543836742,-0.00018784203131144397,-0.0040620632429200724,0.024049319262956677,0.0064785548873356226,0.005913556055400674,0.023764831451787861,-0.030200025082795373,-0.033201579504231138,0.0077033654311813001,0.038436000218109133,-0.010929564080921146,0.11316336992866763,0.051232296301826241,-0.098799688333417193,0.073663669285282632,-0.053301153502911945,-0.082019905156010917],[0.010382638226598816,0.014184282376416337,-0.0099050233615802646,0.018798853981042352,0.0020131915567547969,-0.0022115787433311771,-0.077242662750387159,-0.17084508827934092,-0.098908965461442233,0.12766447594417757,0.18306217069072972,0.0041461931670707854,0.10522650345490939,-0.058599128970456278,-0.2144750564205378,0.20848243702174721,0.11384386497376586,-0.17112802462701185,0.0031376800196902576,0.0073463343143873698,0.03637696765096346,-0.010563220677433734,-0.055592338429731741,-0.016594561915923841,0.074554701170506249,0.14811384548331594,0.10073521746683836,-0.10409456137993235,-0.17874971790188515,-0.023432999180923536,-0.14340858729886957,0.023623958195331703,0.21414063162659122,-0.2087295090287426,-0.082240321419388848,0.17018851802932353,-0.014708687964104053,-0.012273425036916547,-0.019197664714316314,-0.0084784739490306078,0.031173367662717583,0.014643711776628368,0.0030079547343995023,0.02031588193625164,-0.0031823627157087295,-0.02095659218682765,-0.0015142379623618221,0.016773020971161554,0.045651599897066727,0.039806217710202041,-0.0055265814157473177,0.0071320389883176979,-0.035404240132137318,-0.0085405107974072247]])
        self.LW1_2 = np.array([[0.051185883655904867,-3.2761288690674926,-7.8090647737421763,-0.76105249766866612,5.4702591131939489,2.8459761108307031,-2.4408244236201169,-0.93428094563308584,1.3740998940991338,0.6867534700359228,0.40695413628717009,0.66997936266063596,-3.2611765458215252,-4.2607112791412183,2.7039811874431936,-1.4701567904715218,4.0773777327860161,3.0270364207873248,0.73019406625521333,-1.5943311172872459,-0.55316169927778081,-0.13277526897280076,2.3962839482884317,0.12130830709164758,1.9127188408763767,1.1432393501748719,-0.97029649286451614,-1.1755040975562314,0.13217442549252106,0.44393149569251039,1.536603943904618,1.6231880712285667,-1.9553250353501757,-0.19721917519978499,-2.6016604529658021,-1.0942404419195966,-0.55718954333358872,2.1460566179096219,3.013451044986013,0.18180519778300477,-3.3712412846425277,-0.90058184157370602,-0.69229646031181191,-0.49929757201835673,-0.090313500462140345,0.60646787246992329,-0.36045871175914662,-0.26521661276692526,-0.15021006912281071,0.62580019902370332,0.75424122783092384,0.27454573863154608,0.67013030380567085,-0.19272354058587571],[-2.7134703106021076,-5.1040504456975748,-1.3543826198972952,3.2254499023817109,1.0723573864556373,-0.62359614848270084,0.17239473343990186,0.99885305595229879,2.7530339185424828,0.2490246104415359,-1.7156029111935367,-1.6601234027693625,-2.0936413355251928,0.096602882968831266,2.5915016245946996,-1.5538181024164872,-0.28308338083167489,1.1946201347367633,2.0460421919707579,0.81044884805206585,0.65985047080836845,-1.3717639469031571,0.56282684692976293,0.25177782248359704,-0.68801790352663594,-1.2034280601911473,-1.8671141391078845,-0.23051989008966817,1.3853200106202945,1.4268488620047313,1.4920325028317503,-0.48149799299867257,-1.5800706206823847,0.90076453946825641,0.77356291480505435,-0.75442231518284275,-0.62015357777098434,1.2648222959063067,-0.13748799514334711,-0.19522376323200938,-0.84937947760211996,0.040772596074327094,0.1073214283797076,0.81065057718769362,0.21464703114174122,-0.081440604942145736,-0.40258813541820321,-0.35960424211770303,-0.23378840602330336,0.41866587697801672,0.45938489036684493,-0.20232799573487786,-0.1821696188691708,0.013036276439224843],[2.5204397467957809,2.6823053679582372,-0.81340243220917541,-0.53453829102635342,3.0309708572311438,2.5166413111945172,-0.31878652774611677,1.0053477849481902,2.8265267243292795,1.2140824181707852,-2.1130602516228274,-3.0787024983229863,0.62990559855477779,2.5716489057038148,2.4544209408089159,0.85491499992412379,-1.2470110295527266,-0.00083595873066164006,-2.0302551449664943,-0.40804379363473997,0.2044952586577187,-0.085525904024190288,-1.3814581750880659,-1.9859105181278858,0.020848578619305377,-0.50520896191929543,-2.4772697260385028,-1.441150957661758,2.7812875651172249,2.4901387043932055,-0.35760882374267128,-1.6925206848756784,-1.7524068685909704,-0.55410389123258152,0.68781473010451932,0.15625921563668965,0.63854540749434685,-0.61173412462085508,0.32816841940352948,0.36702524362186895,0.027040210741883237,0.59532687282458807,0.19627367629492762,0.17580475022767356,0.86727709884391058,0.54465171535509549,-1.3274883873425316,-0.5551336542999612,-0.33104612190390187,0.098939905872364259,0.032644963646563621,-0.21110621465924193,-0.0080368981584394567,-0.70592052717040221],[2.1506695608621964,3.9366936203628127,6.0103770877834011,5.626575019941197,2.5967319226946444,1.7167517864846167,0.010263582262857712,0.65605009518252133,-0.44031773508672722,-0.39568030495780654,0.53405123252340048,-0.56069862354517652,1.8087348061541535,0.37686123466802529,0.43826439230220571,0.65117802413098191,-0.46400041322141766,1.3767544381244312,-2.5283391374741062,-0.65584365185792981,-1.4965851366116965,-3.9081542019671716,-1.7515631580368769,-2.7391072120053379,-0.36713060903305778,0.0254436173486179,0.95557076372316319,0.62922268382841073,0.22609701857283673,-0.23741105494855796,-0.13688147510154894,-0.18236461896645093,0.053231075304619763,0.41939597336704332,-0.025553482407544327,-0.6836819180709679,1.1328832395078396,-0.60530026281933935,-0.70622356611904291,1.2077388583362152,0.37072140065992498,1.4117176164746204,0.68519290283860612,-0.41180925957917897,-0.44071775106561106,-0.17479266072577671,-0.65548971813629353,0.84546267721080959,-1.5522308887212917,-0.072970575856523251,-0.63204868206148412,-0.84125246224661465,0.089736648513332545,-1.0259019073091118],[1.4996403081629595,3.4001875869223714,3.3169230869015234,0.29214560574084025,-2.1941897186884209,-0.48314984654316251,1.5081438218132712,0.69697524649845055,1.5379338627456258,-1.990967721366536,-0.48759064473747715,-0.74850947084535591,-0.93288322454060357,-0.0065622679393149601,1.1600026277921915,-1.6085260529258263,-0.18868014189333787,1.1138979258090691,-1.4340535235078518,-1.025220010585645,-0.87149302114737826,-0.17740017078077425,0.96510888457227728,-0.32248015009000636,-0.94685923184200005,-0.80455889962557037,-1.810716790986002,2.4607654751746701,1.0143908382217632,-0.12228234896587538,0.93302508099981674,1.0106594279800365,-0.56024657029982727,1.2791976923733979,-0.6534338956321174,-0.60478401993377884,0.41252716368274184,-0.32381748717272552,-0.28169463671269918,-0.0056868519302812077,0.094388758875003337,0.48425362780059494,-0.2017851236501273,0.74454738320744218,0.66902303702983268,-0.98347921173260411,-0.97926685765636223,0.8149153699827314,-0.35977634855817908,-0.96330747531950145,0.1157752255529714,-0.39221918576196507,0.63830564939969503,-0.20940373900245027],[0.46913920203225679,-2.6788894298120867,-6.3898278982158416,-0.93601300026021717,5.5155075132527838,2.7019831346840637,2.1514515218543502,1.231537609689878,-1.4735282996646428,-2.6679538095469271,-0.16325279911801036,1.6743264707967787,-1.0689632730412406,-2.1532864943215615,0.17528834818118777,-3.7308779481083443,-0.71781939301050923,2.4093650030206479,0.59317641195534543,0.38287801145427547,-0.62901602276896207,-0.43920911425355358,0.29532596946672179,0.08131235546463017,-1.6202485472350905,-1.1147449503024605,1.3101957795641044,1.6684973389589808,0.65237891641887236,-0.12806578819473216,0.17548713816221265,0.76028764220501655,0.066347531913833607,1.7215855164907508,0.85571872907578683,-1.3410047876620002,-0.54675533036396384,0.6339471259660856,2.5905938350597046,0.53006885036951268,-1.8973770985331984,-0.85969322976896445,0.32242096864918851,0.37171032484309691,-0.54505861560833258,-0.49325118453333361,-0.71225102655850769,-0.29000567593768756,0.44295873020162591,0.36044161326874924,0.22944599627094572,0.21784598599034616,0.11459745951971428,0.20694454803025353]])

        # Layer 2 #
        self.b2 = np.array([[0.11530558520393674],[0.10814307577139796],[0.0530431961554228],[-0.097710208342730934],[-0.05393791337609205],[-0.035351277073601847],[-0.28174744198388812],[-0.11292129889748379],[-0.091942093219138085],[0.040649659899629216],[0.21855303611715221],[-0.0088726504154032007],[-0.16049178326828659],[-0.059457179475566363],[0.097143663458403168],[0.021643834398980519],[0.32992338619020584],[0.12533434869260818]])
        self.LW2_1 = np.array([[0.054120481342775653,-0.15239883203289722,0.1037349219550789,0.0095824324899378768,0.091048386436723902,-0.0037769722147848084],[0.030820607570341052,-0.084191655978992072,0.028598237450496514,0.0094699848548085094,0.095893753308637877,-0.023553702516296026],[0.0088951243414373098,0.0042118291809150584,-0.049926460112680961,0.089473838296832212,0.072957947947227722,-0.037775906757078481],[-0.013385021149356309,0.10065722671162494,-0.044535104059544452,0.16353903989617347,-0.1043478368043687,0.019082994380147413],[0.005082575053650209,0.023368847719150675,0.034297645271351325,0.088808130844277106,-0.10284058260666333,0.039395200537573519],[0.036796208895908782,-0.054711187629181264,0.1056940318196195,0.08805463592938842,-0.092866158470760934,0.052156642778367401],[-0.11568266197369763,0.019221031322261557,-0.018364859370477452,0.0046230856332878977,0.0020306223123883462,0.13937040908690451],[-0.073494123746996501,0.084384919411592846,0.062049064340960566,-0.030482618446051723,0.095134986217279102,0.083685442801599397],[0.031549022977482369,0.06744732709873684,0.11575798808798689,-0.039519852086109072,0.043742141673009598,-0.07278331598879044],[0.089524040128072288,-0.02886281247670017,0.048640263344043144,0.0081244979890074641,-0.085549754811124826,-0.1431449492253381],[0.059610369783612123,-0.085726378936030828,-0.080238629575379736,0.050802093624153347,-0.081081115371557252,-0.051226511812702817],[0.015653108503974299,-0.052794285224155961,-0.13011166928608492,0.04087886727324555,0.044561684690553681,0.052101752955245377],[-0.11297753521671454,-0.010116087969834835,0.021304285965458743,0.0037274881127946635,-0.12662005692780706,0.082109243638294305],[-0.083131011522563969,0.046110878731095026,0.10677209790724963,-0.030368557513381026,-0.071363720851029919,0.027050007332011454],[0.053217049789427741,0.066521541155969643,0.048005747366801181,-0.036606243326941929,0.14436175599916951,-0.041844966641989875],[0.014604352651608261,-0.044460894716041019,0.044946112620712186,0.019257293301963081,-0.16981445468598491,-0.08110228245328166],[0.11820470720220763,-0.037263905265039414,-0.056567564634465883,0.013013070533006483,0.052418790377934489,-0.093712090951248925],[0.060498072484706643,-0.0084055543101146223,-0.098029613502932905,0.0020659151991739349,0.14781679580903376,0.012657232003072316]])

        # Output 1 #
        self.y1_step1_ymin = np.array([-1])
        self.y1_step1_gain = np.array([[1.43496563544296],[0.737599658933918],[0.847861187488095],[0.847861187488095],[0.726030186011838],[1.43496563544296],[0.819102351466744],[0.972678955784398],[0.852333008040441],[0.855936952026488],[0.987296066592725],[0.83127063915111],[0.937787637051802],[0.797834358417511],[0.844494453529328],[0.866739308088078],[0.799697714264008],[0.965345543023761]])
        self.y1_step1_xoffset = np.array([[0.3484404],[1.003305],[0.5897193],[0.5897193],[0.9663506],[0.3484404],[0.6375437],[0.6939231],[0.7936453],[0.7936453],[0.7288762],[0.6375437],[1.344241],[1.003382],[0.8478722],[0.9228281],[1.003382],[1.404452]])


    def get_network_vars(self):
        return (self.x1_step1_xoffset,
                self.x1_step1_gain,
                self.x1_step1_ymin,
                self.b1,
                self.IW1_1,
                self.LW1_2,
                self.b2,
                self.LW2_1,
                self.y1_step1_ymin,
                self.y1_step1_gain,
                self.y1_step1_xoffset)
