# v6CL_5_3_net.py
# Input: Muscle Contraction.
# Output: Muscle Length.

import numpy as np

class Network(object):
    def __init__(self):
        # Note: This is not a generic Network implementation,
        # but a manually re-expressed set of network
        # weights as trained (and originally implemented) in
        # MATLAB.
        # v6CL_5_3_net, a closed-loop network with 5 hidden
        # layers and 3 delay states in both the input layer and
        # output-feedback-in layer, specifically, as trained
        # on 18-muscle-contraction input and 18-muscle-length output.

        # Input 1 #
        self.x1_step1_xoffset = np.array([[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0]])
        self.x1_step1_gain = np.array([[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2],[0.2]])
        self.x1_step1_ymin = np.array([-1])
        
        # Layer 1 #
        self.b1 = np.array([[0.059781614697710116],[0.37879291541757837],[0.1057019707593784],[0.12060026752932264],[-1.0503202160976681]])
        self.IW1_1 = np.array([[-0.012331893975122391 , 0.079884150560001976 , 0.036050669122820171 , -0.029621523329930625 , -0.035029774409482121 , -0.0017511394555001223 , -0.15828763805478607 , -0.12025653764544636 , -0.05464635738962724 , 0.021611444569477424 , 0.10418782422007346 , 0.19667586918747929 , -0.26398430893823988 , -0.27517700476849205 , 0.026398123397017127 , -0.041184001608415136 , 0.28290693592557831 , 0.29879075240926417 , 0.027018558310702243 , -0.099526374675851362 , -0.064029070611570316 , 0.029164863670956401 , 0.069916041035630511 , 0.0052570427871890474 , 0.13701914292927103 , 0.076060284513069107 , 0.033941989438312226 , 0.0016616935157819823 , -0.069660549823524875 , -0.20776660130685912 , 0.25015657089126858 , 0.27282387765686739 , -0.065647371377136818 , 0.074989090187666099 , -0.24200078195741609 , -0.29982196377960602 , -0.014026862378232844 , 0.019322153560010234 , 0.027359602693838046 , -0.00027199019301706327 , -0.032503151981053573 , -0.0029150332572097639 , 0.019734567760132112 , 0.043788231181391191 , 0.020316584719765465 , -0.023464773327785324 , -0.034248177638627357 , 0.013961177216058751 , 0.007810283689402891 , -0.003392610224511206 , 0.04151447473214933 , -0.036358156574703149 , -0.036235172020642102 , 0.0076830797629122705],[0.028247667370598285 , -0.17173653690695517 , -0.086649858303878571 , 0.070719712036004828 , 0.15223133037954895 , 0.026109884079897911 , 0.31009698641071021 , -0.014961313614512414 , -0.037298725465647782 , 0.05028688821316734 , 0.083509609413225064 , -0.15756892400006237 , 0.73581965786108572 , 0.45969378906964037 , -0.40180651404865114 , 0.33222392737006912 , -0.50384451051671897 , -0.67250930199473036 , -0.034910111476545387 , 0.22938864444544238 , 0.15506568135377227 , -0.061700291478884103 , -0.17920925294144252 , 0.0046591038458058979 , -0.29923097600250514 , 0.090302930647100654 , 0.084630868030957151 , -0.1059330640625835 , -0.20373797612292563 , 0.24051200746901702 , -0.82799439449448042 , -0.56603269805358014 , 0.5322262356302957 , -0.43407344048959062 , 0.48907983487189866 , 0.78959520103515513 , 0.0074312329501414736 , -0.059919528712739936 , -0.07021201276319626 , -0.0078001911110931179 , 0.032198270461922716 , -0.028662751934176448 , -0.0079839640615910479 , -0.079277261040841138 , -0.049974475993084647 , 0.057112107725064643 , 0.12371930489884046 , -0.085430268301402046 , 0.10759561677877287 , 0.11570004017483974 , -0.1412062104390831 , 0.11144312582297101 , 0.0061684159643339894 , -0.13080093766910891],[0.048488438827215694 , -0.15707776911743526 , -0.15636565097206487 , 0.042689817143116315 , 0.17375352413566858 , 0.10025748293303834 , -0.12191814349773156 , -0.81384089289793859 , -0.42752856615140961 , 0.5164208925488003 , 0.94386790082002869 , 0.12220732331622246 , 1.1160424030237144 , 0.15715264149847993 , -1.3167145250638281 , 1.2857238178043879 , -0.15618484869483068 , -1.0658141382282371 , 0.024251501383980922 , 0.11250291656323 , 0.3057681756572066 , -0.017562177270689233 , -0.22811454533248518 , -0.062054146277862918 , 0.11010511340447482 , 0.99659766937257677 , 0.4863971250162647 , -0.64912233867746616 , -1.1908597513350929 , 0.051922413109936144 , -1.2966357162090818 , -0.47281071731958718 , 1.7111024123337475 , -1.5220136991373376 , 0.11107287141094643 , 1.320786443418668 , -0.07512555962628871 , 0.03880656425816699 , -0.14883147391544196 , -0.02089476656431526 , 0.048613199773823085 , -0.03981531214839102 , 0.0070150379045957768 , -0.20008664104487103 , -0.068102204550330142 , 0.14237647867169131 , 0.26249421431861281 , -0.17406447259394028 , 0.20428406870167454 , 0.3234525011653242 , -0.41964821674903263 , 0.26286159316668539 , 0.04095330305788919 , -0.27877084033418764],[0.023774705360560151 , -0.16231660324091091 , -0.10721358273263451 , 0.075980571815140008 , 0.13831834299127477 , 0.027917272733198172 , 0.18640914692940597 , 0.09700284852247229 , 0.06753318524624724 , 0.066967463085752466 , -0.041357791951762993 , -0.31581795364471899 , 0.5437036893484386 , 0.48710906087666911 , -0.1909203063357211 , 0.26034163242342678 , -0.46522036516502158 , -0.6344435733494117 , -0.025709966163474714 , 0.19045736354273965 , 0.17436386799718107 , -0.084851444860736841 , -0.21152131134921229 , -0.044962895589524349 , -0.18573448038244256 , -0.032480700019980199 , -0.022872231872316358 , -0.11188392333791319 , -0.043996676438689784 , 0.36529336297815423 , -0.59034562264048673 , -0.58090300240136317 , 0.29627218685794587 , -0.33714350751862981 , 0.43826273827480089 , 0.69400264161717051 , -1.9294302694262391e-05 , -0.034176677419236974 , -0.067646877432018596 , 0.011718915673195907 , 0.073930355626052865 , 0.016202919125538864 , -0.00014011145905170388 , -0.065861485243308801 , -0.044821624446207305 , 0.047140916476382036 , 0.086771510957627085 , -0.054580687447269106 , 0.058127499758098458 , 0.10403240033718494 , -0.11168630852649399 , 0.084463828852351999 , 0.019712589081328558 , -0.073375791971232202],[-0.034176891492862703 , -0.028952112450500094 , 0.078020601081423613 , 0.013691683430266834 , -0.088617214800752644 , -0.052734308424845534 , 0.29751009152144625 , 0.56684217733833131 , 0.265611610477824 , -0.34315242301367066 , -0.62682561342750331 , -0.23816090670571977 , -0.31208608851045566 , 0.18007577034663064 , 0.66095621741311583 , -0.70108200362484419 , -0.24378131482826143 , 0.29936372267043487 , 0.0057424743670744785 , 0.083560833538585996 , -0.13838605173528404 , -0.0050617912300916761 , 0.072363496745339165 , 0.025292721466380563 , -0.28235075497971529 , -0.61421967000011779 , -0.30338792252681401 , 0.38266260921476103 , 0.74395606853685681 , 0.16134728335028914 , 0.42973106637263969 , -0.019527027118738726 , -0.83280609009806528 , 0.79673079383470691 , 0.2327881624647897 , -0.42685499174494795 , 0.027460158154329305 , -0.054360944185671993 , 0.062198151574477729 , -0.008409195557463077 , 0.014092490278317804 , 0.026787248900094457 , -0.0093048934446126955 , 0.057631064195188327 , 0.041807166467584603 , -0.045802060197322324 , -0.12562331094691606 , 0.075614212804369765 , -0.12403290392419693 , -0.16045095821330685 , 0.18302477198533385 , -0.10853048242268394 , 0.0080730223320944431 , 0.13600566638176737]])
        self.LW1_2 = np.array([[0.14640239810935249 , 4.2097638993488617 , 3.3355807476528572 , -1.2317940980048552 , -6.2181509693980246 , -1.5950715508756852 , 1.1515016714799318 , 0.87019062259949809 , 0.33124883526416476 , 0.81491295104290939 , -0.90487914953073956 , -2.1674016137717533 , 1.6448955911178216 , 2.9051813871868024 , -0.76821526630487291 , 1.3400073285658358 , -2.781431098322769 , -1.8258956431591338 , -0.2059780609149203 , -4.0677976516808458 , -1.9086263370344208 , 0.99814797882421291 , 5.2806634813150799 , 0.93876350399867026 , -1.400183688806351 , -0.9620872265175886 , -0.14164518407077892 , -0.9518303769433355 , 0.50105419848618726 , 2.1558005443195793 , -1.0387926440575697 , -2.1665512451727325 , 1.0982478057089018 , -0.80524273140196367 , 2.5503888746012429 , 1.1213646902175975 , 0.1173030994529262 , 1.150009286751247 , 0.25873413291879876 , -0.35303127097437997 , -1.2980600777756068 , -0.17875596553908232 , 0.6142076317412356 , 0.3845170807201857 , 0.15270509059805681 , 0.28331713237139378 , 0.06040213278802236 , -0.8697947082842642 , 0.16578998722824398 , 0.49174062794706863 , -0.66759983010819501 , 0.077678659251605109 , -0.82761579864777779 , -0.21778388354981501],[-1.0978033965785494 , -0.17706178478089266 , 2.8915417625222295 , 2.7886008268429947 , -4.0233126506864405 , -1.6989297844224629 , -3.3536257645724854 , -0.53869122169885719 , 3.1291621693834957 , 1.0486624023196205 , 0.34921119712962173 , -1.4837908693353066 , -1.8886393526815748 , -1.5910902640016675 , 4.75774580446119 , 0.13952299639685722 , 3.4157070349125167 , 2.0795824005745098 , 0.72572560095969973 , -1.3664480605083285 , -2.6834898489752912 , -2.2970421898355826 , 5.2490190944430637 , 0.91221490600752475 , 3.9776137798172133 , 0.06407591708121603 , -3.2859569671186821 , 0.010135299969859778 , 0.21650105853946641 , 0.28346780812318778 , -0.78280057992258367 , 1.7714582067091091 , -4.4296459193935629 , -1.52455983041952 , -2.8049247749626844 , -1.5136125255274653 , -0.25652553994090055 , 0.99309217344384604 , 1.0114274425976539 , 0.34707760312937552 , -2.2367424753566754 , 0.026786906292268965 , -1.9992616442315385 , 0.43146385586880864 , 1.3722808538802627 , -0.37483575763486454 , -0.69296441338441372 , 0.78217955420653629 , 1.0618411273609376 , -0.96268537085931238 , 1.3750132678740563 , 0.86007275134592742 , 0.9643838285484726 , 0.24517164015555129],[3.3660418544000716 , 3.4744664030006267 , -6.4901849388701489 , -3.2132858605712094 , 5.3612933826085509 , 3.1461954626862121 , 2.9467927104909211 , 4.8228677348361417 , 5.6421868082419282 , -7.750217916084897 , -1.0043929202907185 , -4.758760461519679 , -3.4759828528060162 , -2.1637001955168724 , 6.4516348040150699 , -5.88962262419028 , 1.1604558538883727 , 8.1098410344838143 , -1.8483648552827554 , -5.7279135307338374 , 3.0374675199300101 , 1.7455615436569321 , -0.8637129036105835 , -1.7427675544170966 , -0.28870048350054728 , -6.5552408888113298 , -6.5814708844017495 , 8.6858438710484993 , 1.0052153083440722 , 6.8863699279016597 , -0.61565905041268021 , 3.2405502687422292 , -3.6359634725255709 , 0.78797726582018568 , -1.4715794461223102 , -9.1714415523202035 , -0.11387988279867922 , 2.9528636882539541 , 0.43404245597145358 , -0.35142419697857774 , -1.4755829992287746 , 0.52655190034062327 , -1.8558215821006998 , 3.8518663517088685 , 2.4422939877917442 , -3.3453628975823806 , -1.8148511914498895 , -1.9087849826090635 , 1.7799215423106525 , -1.7786103250717089 , 0.78566237210559653 , 1.268163423455676 , 1.1790069283851525 , 3.4697741525178705],[1.5187604563844661 , 1.726633339932933 , -2.9743796324084801 , -2.1399592798105158 , 2.1271167097633037 , 1.7176053025596476 , 1.0001809016126155 , -0.70735509299482702 , -1.5234823837577645 , -3.4341812393985536 , 1.5383768354419753 , 3.4820457643825851 , -1.8765098314545521 , -3.5227041130867587 , -0.89151435055423411 , -3.5774845082117492 , 2.0123481272733215 , 2.3359045081812639 , -0.57198406785687417 , -1.7867372618267272 , 1.2536793625200531 , 1.2317897774386581 , -0.23407487289291304 , -0.98197709692900137 , 0.089794403695339808 , 0.57306662687599697 , 1.0125050903047366 , 3.7395497728094194 , -0.94143031241360342 , -3.076600626121321 , 1.2007254325029628 , 2.3888717181446055 , 0.81994511406305604 , 2.3666977770437039 , -2.3213126762821124 , -0.82154819328611628 , -0.16068592023331454 , 0.73048802981418559 , 0.29372321604972068 , -0.22476835685428015 , -0.58817035994868894 , 0.21883912187376531 , -0.62255180804293375 , 0.034767677150591494 , -0.50261088468908299 , -1.431433724953205 , -0.28011335304352936 , 1.2654352428346172 , -0.06783688299818405 , -0.49606244623703838 , 0.19019734822492887 , -0.15839717829684258 , 1.2085250751591157 , -0.045779874215790446],[0.78321003594301564 , -1.0858482312445861 , -3.2290875868083666 , -1.6932456712230251 , 6.0063002073156797 , 2.0905846804665678 , -5.2903776289941939 , -3.2705717354402544 , -2.0843881117419216 , 5.0533513581376273 , 1.8099185389646908 , 2.4921793192278803 , 2.5057719600337416 , -0.92193405985228594 , 0.37364879847484006 , 4.7852327747199794 , 2.3971241287164724 , -1.3041720450197591 , -0.7099125187433436 , 2.4798723066640642 , 2.7341232198332484 , 1.6627984046428912 , -7.5205165302427481 , -1.4815210192550146 , 4.6712471023336652 , 4.0578674843816129 , 2.4040962968743482 , -5.6494027658860837 , -1.7224396007399412 , -3.4153938004589897 , -3.0970737394072261 , 0.33977769325252816 , -3.3693596551853764 , -3.1158296475336322 , -1.2025183486760436 , 0.71379964842106858 , 0.37306746289765075 , -1.3729384447010438 , -0.94448042379839281 , -0.36171965573687365 , 2.9981119883381484 , 0.23830571592118102 , -0.80998184713806465 , -2.3331672415919962 , -0.81527115894805025 , 2.4590972048422741 , 1.1834138023914416 , 0.99077763588929546 , 0.9505792756552055 , 0.11358196933638393 , 1.6682454780458942 , 0.27069972896281841 , -0.39762071414144373 , -0.11908534219735374]])
        
        # Layer 2 #
        self.b2 = np.array([[-0.11514415820159457],[-0.1353912922323339],[-0.37222284801476557],[-0.34335442811001332],[-0.10031131234164439],[-0.087933191877053313],[-0.14744019175925382],[-0.009416152155677978],[-0.073756469593490304],[-0.0098433553107054716],[0.088834322992468281],[-0.16209097046245047],[0.032011426639864012],[0.16967811040373387],[-0.019982877398593703],[0.10299100280617954],[0.13288107716573941],[-0.060925767318906927]])
        self.LW2_1 = np.array([[0.28366756123891518 , -0.0036848251281746611 , 0.080855659098446317 , 0.12598815159327031 , 0.15900690037552245],[0.21433201356582554 , 0.035181448389078905 , 0.022711854654809259 , 0.11293977658598293 , 0.067793867273628072],[0.094129977977610038 , 0.06848094552853759 , -0.04250591953761456 , 0.071133407106099639 , -0.044785148599710785],[-0.21830050325680528 , -0.01918023774301807 , -0.040055511672442576 , -0.10930360687725003 , -0.09044567430007816],[-0.13970680981737016 , -0.062206616451647316 , 0.026113765806485674 , -0.09008469733828299 , 0.013835849842947842],[-0.04621384105076716 , -0.093086188225262684 , 0.082675429040917861 , -0.057203115392443528 , 0.11174876219448419],[-0.03839704421947835 , -0.10208162391936336 , -0.020303495842831681 , 0.013649043763448852 , -0.099918036821821321],[-0.0083802723948163422 , -0.040586079208233296 , 0.044793349841534942 , -0.073415544937094915 , -0.065842844982286888],[0.042342774831484235 , 0.048168344041815074 , 0.074148246895645559 , -0.12546308209411308 , 0.057679153451095352],[0.046023206626876943 , 0.069756389712363767 , 0.019144872616516203 , -0.04908982279737259 , 0.12099958003311255],[-0.0052656373639410805 , 0.025567608908441505 , -0.053140200079479546 , 0.090274971936866122 , 0.039448475056353675],[-0.041509321262839641 , -0.002465788649492416 , -0.062461525182436625 , 0.14337520874405763 , -0.060653958698385621],[-0.014631264569611883 , -0.11165503040177384 , -0.020694406378547893 , -0.031111468419857829 , -0.032083907429037016],[0.017271149660031886 , -0.064141606683482857 , 0.039829897769134662 , -0.12266260970012285 , 0.0082083167170769848],[0.019317394044077729 , 0.070041507126542155 , 0.055957075192656573 , -0.05020572119584376 , 0.010350597792002335],[0.027631655539742336 , -0.0088013220721729086 , -0.0079191370725476308 , -0.048248342069692689 , 0.091702727929435845],[0.01430323505401148 , 0.10213862807868966 , -0.0070553055922661003 , 0.06712391603134378 , 0.049569044799600039],[-0.021946498289259184 , 0.059992306831379356 , -0.019594005958439711 , 0.11082702934421451 , -0.046064012024115274]])
        
        # Output 1 #
        self.y1_step1_ymin = np.array([-1])
        self.y1_step1_gain = np.array([[1.43496563544296],[0.750819237640671],[0.847861187488095],[0.847861187488095],[0.731317444608646],[1.43496563544296],[0.827960456443008],[0.97588781271776],[0.842541007629335],[0.86927393503403],[0.987248305980632],[0.829788304822568],[0.958918033604323],[0.80049758930151],[0.818379460541446],[0.893205772235118],[0.80051617282824],[0.973551051800218]])
        self.y1_step1_xoffset = np.array([[0.3484404],
                                          [1.03091],
                                          [0.5897193],
                                          [0.5897193],
                                          [0.9956645],
                                          [0.3484404],
                                          [0.6375437],
                                          [0.6939231],
                                          [0.7936453],
                                          [0.7936453],
                                          [0.7288762],
                                          [0.6375437],
                                          [1.393628],
                                          [1.003382],
                                          [0.8599379],
                                          [0.9178703],
                                          [1.003382],
                                          [1.424492]])

    def get_network_vars(self):
        return (self.x1_step1_xoffset,
                self.x1_step1_gain,
                self.x1_step1_ymin,
                self.b1,
                self.IW1_1,
                self.LW1_2,
                self.b2,
                self.LW2_1,
                self.y1_step1_ymin,
                self.y1_step1_gain,
                self.y1_step1_xoffset)
